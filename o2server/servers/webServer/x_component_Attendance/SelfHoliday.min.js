MWF.xDesktop.requireApp("Attendance","Explorer",null,!1),MWF.xDesktop.requireApp("Selector","package",null,!1),MWF.xDesktop.requireApp("Template","Explorer",null,!1),MWF.xApplication.Attendance.SelfHoliday=new Class({Extends:MWF.xApplication.Attendance.Explorer,Implements:[Options,Events],initialize:function(t,e,i,l){this.setOptions(l),this.app=e,this.path="/x_component_Attendance/$SelfHoliday/",this.cssPath="/x_component_Attendance/$SelfHoliday/"+this.options.style+"/css.wcss",this._loadCss(),this.actions=i,this.node=$(t),this.initData(),this.personActions||(this.personActions=new MWF.xAction.org.express.RestActions)},load:function(){this.loadToolbar(),this.loadFilter(),this.loadContentNode(),this.loadView(),this.setNodeScroll()},loadFilter:function(){this.fileterNode=new Element("div.fileterNode",{styles:this.css.fileterNode}).inject(this.node),this._loadFilterContent()},exportExcel:function(){new MWF.xApplication.Attendance.SelfHoliday.ExportExcelForm(this).edit()},_loadFilterContent:function(){var t=this;this.fileterNode.set("html","<table bordr='0' cellpadding='5' cellspacing='0' styles='formTable' width='1350'><tr>    <td styles='formTableTitle' lable='q_topUnitName'></td>    <td styles='formTableValue' item='q_topUnitName'></td>    <td styles='formTableTitle' lable='q_unitName'></td>    <td styles='formTableValue' item='q_unitName'></td>    <td styles='formTableTitle' lable='q_empName'></td>    <td styles='formTableValue' item='q_empName'></td>    <td styles='formTableTitle' lable='startdateString'></td>    <td styles='formTableValue' item='startdateString'></td>    <td styles='formTableTitle' lable='enddateString'></td>    <td styles='formTableValue' item='enddateString'></td>    <td styles='formTableValue' item='action'></td></tr></table>"),MWF.xDesktop.requireApp("Template","MForm",function(){this.filter=new MForm(this.fileterNode,{},{style:"filter",isEdited:!0,itemTemplate:{q_topUnitName:{text:"选择公司",type:"org",orgType:"unit",style:{"min-width":"200px"}},q_unitName:{text:"选择部门",type:"org",orgType:"unit",style:{"min-width":"250px"}},q_empName:{text:"选择人员",type:"org",orgType:"person",style:{"min-width":"100px"}},startdateString:{text:"开始日期",tType:"date",style:{border:"1px solid rgb(153, 153, 153)",background:'url("../x_component_Template/$MForm/default/icon/calendar.png") 98% center no-repeat',"border-radius":"3px","box-shadow":"rgb(204, 204, 204) 0px 0px 6px",height:"26px",width:"100px"}},enddateString:{text:"结束日期",tType:"date",style:{border:"1px solid rgb(153, 153, 153)",background:'url("../x_component_Template/$MForm/default/icon/calendar.png") 98% center no-repeat',"border-radius":"3px","box-shadow":"rgb(204, 204, 204) 0px 0px 6px",height:"26px",width:"100px"}},action:{type:"button",value:"查询",event:{click:function(){var e=t.filter.getResult(!0,",",!0,!0,!0);this.loadView(e)}.bind(this)}}}},this.app,this.css),this.filter.load()}.bind(this),!0)},loadView:function(t){this.elementContentNode.empty(),this.view=new MWF.xApplication.Attendance.SelfHoliday.View(this.elementContentNode,this.app,this,this.viewData,this.options.searchKey),this.view.filterData=t,this.view.load(),this.setContentSize()},createDocument:function(){this.view&&this.view._createDocument()}}),MWF.xApplication.Attendance.SelfHoliday.View=new Class({Extends:MWF.xApplication.Attendance.Explorer.View,_createItem:function(t){return new MWF.xApplication.Attendance.SelfHoliday.Document(this.table,t,this.explorer,this)},_getCurrentPageData:function(t,e){e||(e=20);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)",l=this.filterData||{};this.actions.listSelfHolidayFilterNext(i,e,l,(function(e){t&&t(e)}))},_removeDocument:function(t,e){this.actions.deleteSelfHoliday(t.id,function(t){this.explorer.view.reload(),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_createDocument:function(){new MWF.xApplication.Attendance.SelfHoliday.Form(this.explorer).create()},_openDocument:function(t){new MWF.xApplication.Attendance.SelfHoliday.Form(this.explorer,t).open()}}),MWF.xApplication.Attendance.SelfHoliday.Document=new Class({Extends:MWF.xApplication.Attendance.Explorer.Document}),MWF.xApplication.Attendance.SelfHoliday.ExportExcelForm=new Class({Extends:MWF.xApplication.Attendance.Explorer.PopupForm,_createTableContent:function(){this.formTableArea.set("html","<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr><td colspan='2' styles='formTableHead'>导出员工休假记录</td></tr><tr>    <td styles='formTableTitle' lable='startDate'></td>    <td styles='formTableValue' item='startDate'></td></tr><tr>    <td styles='formTableTitle' lable='endDate'></td>    <td styles='formTableValue' item='endDate'></td></tr></table>"),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.formTableArea,{q_empName:layout.desktop.session.user.distinguishedName},{isEdited:!0,itemTemplate:{startDate:{text:"开始日期",tType:"date"},endDate:{text:"结束日期",tType:"date"}}},this.app),this.form.load()}.bind(this),!0)},_ok:function(t,e){this.app.restActions.exportSelfHoliday(t.startDate,t.endDate,function(t){e&&e(t)}.bind(this)),this.close()}}),MWF.xApplication.Attendance.SelfHoliday.Form=new Class({Extends:MWF.xApplication.Attendance.Explorer.PopupForm,options:{width:600,height:450,hasTop:!0,hasBottom:!0,title:"",draggable:!0,closeAction:!0},_createTableContent:function(){this.formTableArea.set("html","<table width='100%' bordr='0' cellpadding='5' cellspacing='0' styles='formTable'><tr><td colspan='2' styles='formTableHead'>员工休假记录</td></tr><tr><td styles='formTabelTitle' lable='unitName'></td>    <td styles='formTableValue' item='unitName'></td></tr><tr><td styles='formTabelTitle' lable='employeeName'></td>    <td styles='formTableValue' item='employeeName'></td></tr><tr><td styles='formTabelTitle' lable='leaveType'></td>    <td styles='formTableValue' item='leaveType'></td></tr><tr><td styles='formTabelTitle' lable='startTime'></td>    <td styles='formTableValue' item='startTime'></td></tr><tr><td styles='formTabelTitle' lable='endTime'></td>    <td styles='formTableValue' item='endTime'></td></tr><tr><td styles='formTabelTitle' lable='leaveDayNumber'></td>    <td styles='formTableValue' item='leaveDayNumber'></td></tr></table>"),MWF.xDesktop.requireApp("Template","MForm",function(){this.form=new MForm(this.formTableArea,this.data,{isEdited:this.isEdited||this.isNew,itemTemplate:{unitName:{text:"部门",type:"org",orgType:"unit",notEmpty:!0},employeeName:{text:"员工姓名",type:"org",orgType:"person",notEmpty:!0},leaveType:{text:"休假类型",type:"select",notEmpty:!0,selectValue:"带薪年休假,带薪病假,带薪福利假,扣薪事假,其他".split(",")},startTime:{text:"开始时间",tType:"datetime",notEmpty:!0},endTime:{text:"结束时间",tType:"datetime",notEmpty:!0},leaveDayNumber:{text:"休假天数",tType:"number",notEmpty:!0}}},this.app),this.form.load()}.bind(this),!0)},_ok:function(t,e){this.app.restActions.saveSelfHoliday(t,function(t){e&&e(t)}.bind(this))}});