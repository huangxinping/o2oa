MWF.xApplication.Execution=MWF.xApplication.Execution||{},MWF.xDesktop.requireApp("Template","Explorer",null,!1),MWF.require("MWF.widget.Identity",null,!1),MWF.xApplication.Execution.WorkReportList=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default",workNavi1:""},initialize:function(t,e,i,o){this.setOptions(o),this.app=e,this.lp=e.lp.WorkReportList,this.path="../x_component_Execution/$WorkReportList/",this.loadCss(),this.actions=i,this.node=$(t)},loadCss:function(){this.cssPath="../x_component_Execution/$WorkReportList/"+this.options.style+"/css.wcss",this._loadCss()},load:function(){this.tabLocation="",this.middleContent=this.app.middleContent,this.middleContent.setStyles({"margin-top":"0px",border:"0px solid #f00"}),this.createNaviContent(),this.createContentDiv(),this.resizeWindow(),this.app.addEvent("resize",function(){this.resizeWindow()}.bind(this))},resizeWindow:function(){var t=this.app.middleContent.getSize();this.naviDiv.setStyles({height:t.y-60+"px"}),this.naviContentDiv.setStyles({height:t.y-180+"px"}),this.contentDiv.setStyles({height:t.y-60+"px"}),this.rightContentDiv.setStyles({height:t.y-40-100+"px"})},createNaviContent:function(){this.naviDiv=new Element("div.naviDiv",{styles:this.css.naviDiv}).inject(this.middleContent),this.naviTitleDiv=new Element("div.naviTitleDiv",{styles:this.css.naviTitleDiv,text:this.lp.title}).inject(this.naviDiv),this.naviContentDiv=new Element("div.naviContentDiv",{styles:this.css.naviContentDiv}).inject(this.naviDiv),this.naviBottomDiv=new Element("div.naviBottomDiv",{styles:this.css.naviBottomDiv}).inject(this.naviDiv);var t=new Element("li.naviContentLi",{styles:this.css.naviContentLi}).inject(this.naviContentDiv).addEvents({click:function(){this.app.openTask()}.bind(this)});new Element("img.naviContentImg",{styles:this.css.naviContentImg,src:"../x_component_Execution/$WorkReportList/default/icon/Prototype-100.png"}).inject(t),new Element("span.naviContentSpan",{styles:this.css.naviContentSpan,text:this.lp.naviItem.workDeploy}).inject(t)},createContentDiv:function(){this.contentDiv=new Element("div.contentDiv",{styles:this.css.contentDiv}).inject(this.middleContent),this.createCategoryItemDiv(),this.createSearchDiv(),this.createRightContentDiv()},createCategoryItemDiv:function(){this.rightCategoryDiv=new Element("div.rightCategoryDiv",{styles:this.css.rightCategoryDiv}).inject(this.contentDiv),this.rightCategoryItemDiv=new Element("div.rightCategoryItemDiv",{styles:this.css.rightCategoryItemDiv}).inject(this.rightCategoryDiv),this.drafterLi=new Element("li.drafterLi",{styles:this.css.rightCategoryItemLi,text:this.lp.drafterTab}).inject(this.rightCategoryItemDiv).addEvents({click:function(){this.createView("drafter")}.bind(this)}),this.todoLi=new Element("li.todoLi",{styles:this.css.rightCategoryItemCurrentLi,text:this.lp.todoTab}).inject(this.rightCategoryItemDiv).addEvents({click:function(){this.createView("todo")}.bind(this)}),this.doneLi=new Element("li.doneLi",{styles:this.css.rightCategoryItemLi,text:this.lp.doneTab}).inject(this.rightCategoryItemDiv).addEvents({click:function(){this.createView("done")}.bind(this)}),this.archiveLi=new Element("li.archiveLi",{styles:this.css.rightCategoryItemLi,text:this.lp.archiveTab}).inject(this.rightCategoryItemDiv).addEvents({click:function(){this.createView("archive")}.bind(this)})},createView:function(t){this.workNavi1=t||"todo","done"==t?(this.drafterLi.setStyles({"border-bottom":""}),this.todoLi.setStyles({"border-bottom":""}),this.doneLi.setStyles({"border-bottom":"2px solid #124c93"}),this.archiveLi.setStyles({"border-bottom":""}),this.createDoneView()):"drafter"==t?(this.drafterLi.setStyles({"border-bottom":"2px solid #124c93"}),this.todoLi.setStyles({"border-bottom":""}),this.doneLi.setStyles({"border-bottom":""}),this.archiveLi.setStyles({"border-bottom":""}),this.createDrafterView()):"archive"==t?(this.drafterLi.setStyles({"border-bottom":""}),this.todoLi.setStyles({"border-bottom":""}),this.doneLi.setStyles({"border-bottom":""}),this.archiveLi.setStyles({"border-bottom":"2px solid #124c93"}),this.createArchiveView()):(this.drafterLi.setStyles({"border-bottom":""}),this.todoLi.setStyles({"border-bottom":"2px solid #124c93"}),this.doneLi.setStyles({"border-bottom":""}),this.archiveLi.setStyles({"border-bottom":""}),this.createTodoView())},createSearchDiv:function(){this.rightSearchDiv=new Element("div.rightSearchDiv",{styles:this.css.rightSearchDiv}).inject(this.contentDiv),rightSearchBarSpan=new Element("span.rightSearchBarSpan",{styles:this.css.rightSearchBarSpan}).inject(this.rightSearchDiv),this.rightSearchBarInput=new Element("input",{styles:this.css.rightSearchBarInput,type:"text"}).inject(rightSearchBarSpan).addEvents({keyup:function(t){13==t.code&&this.searchAction()}.bind(this)}),this.rightSearchBarSearch=new Element("div.rightSearchBarSearch",{styles:this.css.rightSearchBarSearch,text:MWF.xApplication.Execution.LP.workTask.search}).inject(rightSearchBarSpan).addEvents({click:function(){this.searchAction()}.bind(this)})},searchAction:function(){var t={};t.title=this.rightSearchBarInput.get("value"),this.drafterView&&this.createDrafterView(t),this.todoView&&this.createTodoView(t),this.doneView&&this.createDoneView(t)},createRightContentDiv:function(){this.rightContentDiv&&this.rightContentDiv.destroy(),this.rightContentDiv=new Element("div.rightContentDiv",{styles:this.css.rightContentDiv}).inject(this.contentDiv),this.createView(this.options.workNavi1)},createTodoView:function(t){this.drafterView&&delete this.drafterView,this.todoView&&delete this.todoView,this.doneView&&delete this.doneView,this.archiveView&&delete this.archiveView,this.reloadRightContentDiv(),this.rightContentDiv.setStyles({height:this.app.middleContent.getSize().y-40-100+"px"}),this.scrollBar&&this.scrollBar.scrollVAreaNode&&this.scrollBar.scrollVAreaNode.destroy(),MWF.require("MWF.widget.ScrollBar",function(){this.scrollBar=new MWF.widget.ScrollBar(this.rightContentDiv,{indent:!1,style:"xApp_TaskList",where:"before",distance:30,friction:4,axis:{x:!1,y:!0},onScroll:function(t){var e=this.rightContentDiv.getScrollSize(),i=this.rightContentDiv.getSize(),o=e.y-i.y,n=this.todoView;t+200>o&&n&&n.loadElementList&&(n.isItemsLoaded||n.loadElementList())}.bind(this)})}.bind(this),!1),this.todoView=new MWF.xApplication.Execution.WorkReportList.todoView(this.rightContentDiv,this.app,this,{templateUrl:this.path+"listItem_todo.json",filterData:t},{lp:this.lp.view}),this.todoView.load()},createDrafterView:function(t){this.drafterView&&delete this.drafterView,this.todoView&&delete this.todoView,this.doneView&&delete this.doneView,this.archiveView&&delete this.archiveView,this.reloadRightContentDiv(),this.rightContentDiv.setStyles({height:this.app.middleContent.getSize().y-40-100+"px"}),this.scrollBar&&this.scrollBar.scrollVAreaNode&&this.scrollBar.scrollVAreaNode.destroy(),MWF.require("MWF.widget.ScrollBar",function(){this.scrollBar=new MWF.widget.ScrollBar(this.rightContentDiv,{indent:!1,style:"xApp_TaskList",where:"before",distance:30,friction:4,axis:{x:!1,y:!0},onScroll:function(t){var e=this.rightContentDiv.getScrollSize(),i=this.rightContentDiv.getSize(),o=e.y-i.y,n=this.drafterView;t+200>o&&n&&n.loadElementList&&(n.isItemsLoaded||n.loadElementList())}.bind(this)})}.bind(this),!1),this.drafterView=new MWF.xApplication.Execution.WorkReportList.DrafterView(this.rightContentDiv,this.app,this,{templateUrl:this.path+"listItem_drafter.json",filterData:t},{lp:this.lp.view}),this.drafterView.load()},reloadRightContentDiv:function(){this.rightContentDiv&&this.rightContentDiv.destroy(),this.rightContentDiv=new Element("div.rightContentDiv",{styles:this.css.rightContentDiv}).inject(this.contentDiv)},createDoneView:function(t){this.drafterView&&delete this.drafterView,this.todoView&&delete this.todoView,this.doneView&&delete this.doneView,this.archiveView&&delete this.archiveView,this.reloadRightContentDiv(),this.rightContentDiv.setStyles({height:this.app.middleContent.getSize().y-40-100+"px"}),this.scrollBar&&this.scrollBar.scrollVAreaNode&&this.scrollBar.scrollVAreaNode.destroy(),MWF.require("MWF.widget.ScrollBar",function(){this.scrollBar=new MWF.widget.ScrollBar(this.rightContentDiv,{indent:!1,style:"xApp_TaskList",where:"before",distance:30,friction:4,axis:{x:!1,y:!0},onScroll:function(t){var e=this.rightContentDiv.getScrollSize(),i=this.rightContentDiv.getSize();t+200>e.y-i.y&&this.doneView&&this.doneView.loadElementList&&(this.doneView.isItemsLoaded||this.doneView.loadElementList())}.bind(this)})}.bind(this),!1),this.doneView=new MWF.xApplication.Execution.WorkReportList.doneView(this.rightContentDiv,this.app,this,{templateUrl:this.path+"listItem_done.json",filterData:t},{lp:this.lp.view}),this.doneView.load()},createArchiveView:function(t){this.drafterView&&delete this.drafterView,this.todoView&&delete this.todoView,this.doneView&&delete this.doneView,this.archiveView&&delete this.archiveView,this.reloadRightContentDiv(),this.rightContentDiv.setStyles({height:this.app.middleContent.getSize().y-40-100+"px"}),this.scrollBar&&this.scrollBar.scrollVAreaNode&&this.scrollBar.scrollVAreaNode.destroy(),MWF.require("MWF.widget.ScrollBar",function(){this.scrollBar=new MWF.widget.ScrollBar(this.rightContentDiv,{indent:!1,style:"xApp_TaskList",where:"before",distance:30,friction:4,axis:{x:!1,y:!0},onScroll:function(t){var e=this.rightContentDiv.getScrollSize(),i=this.rightContentDiv.getSize();t+200>e.y-i.y&&this.archiveView&&this.archiveView.loadElementList&&(this.archiveView.isItemsLoaded||this.archiveView.loadElementList())}.bind(this)})}.bind(this),!1),this.archiveView=new MWF.xApplication.Execution.WorkReportList.archiveView(this.rightContentDiv,this.app,this,{templateUrl:this.path+"listItem_archive.json",filterData:t},{lp:this.lp.view}),this.archiveView.load()}}),MWF.xApplication.Execution.WorkReportList.DrafterView=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,_createDocument:function(t){return new MWF.xApplication.Execution.WorkReportList.DrafterDocument(this.viewNode,t,this.explorer,this)},_getCurrentPageData:function(t,e){e||(e=20);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)";"(0)"==i&&this.app.createShade();var o=this.options.filterData||{};this.actions.getWorkReportDrafterNext(i,e,o,function(e){t&&t(e),this.app.destroyShade()}.bind(this))},_removeDocument:function(t,e){this.actions.deleteWortReport(t.id,function(t){t.type&&"success"==t.type&&(this.explorer.createDrafterView(),this.app.notice(this.explorer.lp.prompt.deleteWortReport,"success"))}.bind(this),function(t,e,i){var o=i;t&&(errorMessage=t.responseText);var n=JSON.parse(errorMessage);n.message?this.app.notice(n.message,"error"):this.app.notice(o,"error")}.bind(this))},_create:function(){},_openDocument:function(t){MWF.xDesktop.requireApp("Execution","WorkReport",function(){var e={workReportId:t.id,workId:t.workId};this.workReport=new MWF.xApplication.Execution.WorkReport(this,this.actions,e,{isEdited:!1,onReloadView:function(t){this.explorer.createDrafterView()}.bind(this)}),this.workReport.load()}.bind(this))},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){}}),MWF.xApplication.Execution.WorkReportList.DrafterDocument=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,action_open:function(){},_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){t.getElements("div[item='title']")&&t.getElements("div[item='title']").set("title",e.title)},removeCenterWork:function(t){return!1}}),MWF.xApplication.Execution.WorkReportList.todoView=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,_createDocument:function(t){return new MWF.xApplication.Execution.WorkReportList.todoDocument(this.viewNode,t,this.explorer,this)},_getCurrentPageData:function(t,e){e||(e=20);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)";"(0)"==i&&this.app.createShade();var o=this.options.filterData||{};this.actions.getWorkReportTodoNext(i,e,o,function(e){t&&t(e),this.app.destroyShade()}.bind(this))},_removeDocument:function(t,e){this.actions.deleteCenterWork(t.id,function(t){"centerDrafter"==this.tabLocation?this.app.workTask.loadCenterWorkList("drafter"):"centerDeploy"==this.tabLocation&&this.app.workTask.loadCenterWorkList("deploy"),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_create:function(){},_openDocument:function(t){MWF.xDesktop.requireApp("Execution","WorkReport",function(){var e={workReportId:t.workReportId,workId:t.workId};this.workReport=new MWF.xApplication.Execution.WorkReport(this,this.actions,e,{isEdited:!1,onReloadView:function(t){this.explorer.createTodoView()}.bind(this)}),this.workReport.load()}.bind(this))},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){}}),MWF.xApplication.Execution.WorkReportList.todoDocument=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,action_open:function(){},_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){t.getElements("div[item='title']")&&t.getElements("div[item='title']").set("title",e.title)},removeCenterWork:function(t){return!1}}),MWF.xApplication.Execution.WorkReportList.doneView=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,_createDocument:function(t){return new MWF.xApplication.Execution.WorkReportList.doneDocument(this.viewNode,t,this.explorer,this)},_getCurrentPageData:function(t,e){e||(e=20);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)";"(0)"==i&&this.app.createShade();var o=this.options.filterData||{};this.actions.getWorkReportDoneNext(i,e,o,function(e){t&&t(e),this.app.destroyShade()}.bind(this))},_removeDocument:function(t,e){this.actions.deleteCenterWork(t.id,function(t){"centerDrafter"==this.tabLocation?this.app.workTask.loadCenterWorkList("drafter"):"centerDeploy"==this.tabLocation&&this.app.workTask.loadCenterWorkList("deploy"),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_create:function(){},_openDocument:function(t){MWF.xDesktop.requireApp("Execution","WorkReport",function(){var e={workReportId:t.workReportId,workId:t.workId};this.workReport=new MWF.xApplication.Execution.WorkReport(this,this.actions,e,{isEdited:!1,onReloadView:function(t){this.explorer.createDoneView()}.bind(this)}),this.workReport.load()}.bind(this))},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){}}),MWF.xApplication.Execution.WorkReportList.doneDocument=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,action_open:function(){MWF.xDesktop.requireApp("Execution","WorkDeploy",function(){var t="centerDrafter"==this.view.tabLocation||"baseDrafter"==this.view.tabLocation;this.workDeploy=new MWF.xApplication.Execution.WorkDeploy(this.view,this.view.app.restActions,{id:this.data.id},{isEdited:t,centerWorkId:this.data.id}),this.workDeploy.load()}.bind(this))},_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){t.getElements("div[item='title']")&&t.getElements("div[item='title']").set("title",e.title)},removeCenterWork:function(t){return!1}}),MWF.xApplication.Execution.WorkReportList.archiveView=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,_createDocument:function(t){return new MWF.xApplication.Execution.WorkReportList.archiveDocument(this.viewNode,t,this.explorer,this)},_getCurrentPageData:function(t,e){e||(e=20);var i=this.items.length?this.items[this.items.length-1].data.id:"(0)";"(0)"==i&&this.app.createShade();var o=this.options.filterData||{};this.actions.getWorkReportArchiveNext(i,e,o,function(e){t&&t(e),this.app.destroyShade()}.bind(this))},_removeDocument:function(t,e){this.actions.deleteCenterWork(t.id,function(t){"centerDrafter"==this.tabLocation?this.app.workTask.loadCenterWorkList("drafter"):"centerDeploy"==this.tabLocation&&this.app.workTask.loadCenterWorkList("deploy"),this.app.notice(this.app.lp.deleteDocumentOK,"success")}.bind(this))},_create:function(){},_openDocument:function(t){MWF.xDesktop.requireApp("Execution","WorkReport",function(){var e={workReportId:t.workReportId,workId:t.workId};this.workReport=new MWF.xApplication.Execution.WorkReport(this,this.actions,e,{isEdited:!1,onReloadView:function(t){this.explorer.createDoneView()}.bind(this)}),this.workReport.load()}.bind(this))},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){}}),MWF.xApplication.Execution.WorkReportList.archiveDocument=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,action_open:function(){MWF.xDesktop.requireApp("Execution","WorkDeploy",function(){var t="centerDrafter"==this.view.tabLocation||"baseDrafter"==this.view.tabLocation;this.workDeploy=new MWF.xApplication.Execution.WorkDeploy(this.view,this.view.app.restActions,{id:this.data.id},{isEdited:t,centerWorkId:this.data.id}),this.workDeploy.load()}.bind(this))},_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){t.getElements("div[item='title']")&&t.getElements("div[item='title']").set("title",e.title)},removeCenterWork:function(t){return!1}});