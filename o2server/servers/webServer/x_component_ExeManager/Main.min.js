MWF.xApplication.ExeManager=MWF.xApplication.ExeManager||{},MWF.require("MWF.widget.Identity",null,!1),MWF.xDesktop.requireApp("ExeManager","Actions.RestActions",null,!1),MWF.xDesktop.requireApp("Template","Explorer",null,!1),MWF.xApplication.ExeManager.options={multitask:!1,executable:!0},MWF.xApplication.ExeManager.Main=new Class({Extends:MWF.xApplication.Common.Main,Implements:[Options,Events],options:{style:"default",name:"ExeManager",icon:"icon1.png",width:"1270",height:"700",isResize:!1,isMax:!0,title:MWF.xApplication.ExeManager.LP.main.topBartitle},onQueryLoad:function(){this.lp=MWF.xApplication.ExeManager.LP},loadApplication:function(t){this.restActions=MWF.Actions.get("x_okr_assemble_control"),this.orgActions=MWF.Actions.get("x_organization_assemble_express"),this.createContainer(),this.createTopBar()},createContainer:function(){this.container||(this.content.setStyle("overflow","hidden"),this.container=new Element("div",{styles:this.css.container}).inject(this.content))},createTopBar:function(){this.currentTopBarTab="todo",this.topBar?this.topBar.empty():this.topBar=new Element("div.topBar",{styles:this.css.topBar}).inject(this.container),this.topBarContent=new Element("div",{styles:this.css.topBarContent}).inject(this.topBar),this.topBarTitleLi=new Element("li",{styles:this.css.topBarTitleLi}).inject(this.topBarContent),this.topBarLog=new Element("img",{styles:this.css.topBarLog,src:this.path+"default/icon/okr.png"}).inject(this.topBarTitleLi),this.topBarTitleSpan=new Element("span",{styles:this.css.topBarTitleSpan,text:this.lp.main.topBartitle}).inject(this.topBarTitleLi);var t=this.lp.main.topBarList;for(var e in t){var i=new Element("li.topBarLi",{styles:this.css.topBarLi,id:e}).inject(this.topBarContent),n=this;i.addEvents({mouseover:function(){n.currentTopBarTab!=this.get("id")&&this.setStyles({"background-color":"#124c93"})},mouseout:function(){n.currentTopBarTab!=this.get("id")&&this.setStyles({"background-color":"#5c97e1"})},click:function(){n.openContent(this)}});new Element("span",{styles:this.css.topBarSpan,text:t[e]}).inject(i)}this.topBarContent.getElementById("topTodo").click()},openContent:function(t){this.currentTopBarTab=t.get("id"),this.topBarContent.getElements("li").each((function(t){"topBarLi"==t.className&&t.setStyles({"background-color":"#5c97e1"})})),t.setStyles({"background-color":"#124c93"}),this.middleContent||(this.middleContent=new Element("div.middleContent",{styles:this.css.middleContent}).inject(this.container)),"topTodo"==this.currentTopBarTab?(this.middleContent&&this.middleContent.empty(),MWF.xDesktop.requireApp("ExeManager","TodoList",function(){new MWF.xApplication.ExeManager.TodoList(this.middleContent,this,this.restActions,{}).load()}.bind(this),!0)):"topCenterWork"==this.currentTopBarTab?(this.middleContent&&this.middleContent.empty(),MWF.xDesktop.requireApp("ExeManager","CenterWorkList",function(){new MWF.xApplication.ExeManager.CenterWorkList(this.middleContent,this,this.restActions,{}).load()}.bind(this),!0)):"topBaseWork"==this.currentTopBarTab?(this.middleContent&&this.middleContent.empty(),MWF.xDesktop.requireApp("ExeManager","BaseWorkList",function(){new MWF.xApplication.ExeManager.BaseWorkList(this.middleContent,this,this.restActions,{}).load()}.bind(this),!0)):"topWorkReport"==this.currentTopBarTab?(this.middleContent&&this.middleContent.empty(),MWF.xDesktop.requireApp("ExeManager","WorkReportList",function(){new MWF.xApplication.ExeManager.WorkReportList(this.middleContent,this,this.restActions,{}).load()}.bind(this),!0)):"topIndentity"==this.currentTopBarTab&&(this.middleContent&&this.middleContent.empty(),MWF.xDesktop.requireApp("ExeManager","IndentityList",function(){new MWF.xApplication.ExeManager.IndentityList(this.middleContent,this,this.restActions,{}).load()}.bind(this),!0))},createMiddleContent:function(){this.middleContent||(this.middleContent=new Element("div.middleContent",{styles:this.css.middleContent}).inject(this.container))},createShade:function(t,e){var i=this.content;t=t||i,e=e||"loading...";this.shadeDiv&&this.shadeDiv.destroy(),this.shadeTxtDiv&&this.shadeTxtDiv.destroy(),this.shadeDiv=new Element("div.shadeDiv").inject(t),this.inforDiv=new Element("div.inforDiv",{styles:{height:"16px",display:"inline-block",position:"absolute","background-color":"#000000","border-radius":"3px",padding:"5px 10px"}}).inject(this.shadeDiv),this.loadImg=new Element("img.loadImg",{styles:{width:"16px",height:"16px",float:"left"},src:"../x_component_Execution/$Main/default/icon/loading.gif"}).inject(this.inforDiv),this.shadeTxtSpan=new Element("span.shadeTxtSpan").inject(this.inforDiv),this.shadeTxtSpan.set("text",e),this.shadeDiv.setStyles({width:"100%",height:"100%",position:"absolute",opacity:"0.6","background-color":"#cccccc","z-index":"999"}),this.shadeTxtSpan.setStyles({color:"#ffffff","font-size":"12px",display:"inline-block","line-height":"16px","padding-left":"5px"});var n=t.getSize().x,s=t.getSize().y;this.shadeDiv.setStyles({left:t.getLeft()-i.getLeft()+"px",top:t.getTop()-i.getTop()+"px",width:n+"px",height:s+"px"}),"absolute"==t.getStyle("position")&&this.shadeDiv.setStyles({left:"0px",top:"0px"}),this.inforDiv.setStyles({left:n/2+"px",top:s/2+"px"})},destroyShade:function(){this.shadeDiv&&this.shadeDiv.destroy()},setScrollBar:function(t,e,i,n,s){return i||(i="attachment"),n||(n={V:{x:0,y:0},H:{x:0,y:0}}),MWF.require("MWF.widget.ScrollBar",(function(){this.scrollbar&&delete this.scrollbar,this.scrollbar=new MWF.widget.ScrollBar(t,{style:i,offset:n,indent:!1,distance:50,onScroll:function(i){var n=t.getScrollSize(),s=t.getSize();i+200>n.y-s.y&&e&&e.loadElementList&&(e.isItemsLoaded||e.loadElementList())}.bind(this)}),s&&s()})),!1},showErrorMessage:function(t,e,i){var n=i;if(t&&(errorMessage=t.responseText),""!=errorMessage){var s=JSON.parse(errorMessage);s.message?this.notice(s.message,"error"):this.notice(n,"error")}else this.notice(n,"error")}});