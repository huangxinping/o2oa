MWF.xApplication.Selector=MWF.xApplication.Selector||{},MWF.xDesktop.requireApp("Selector","Identity",null,!1),MWF.xApplication.Selector.FormField=new Class({Extends:MWF.xApplication.Selector.Identity,options:{style:"default",count:0,title:MWF.xApplication.Selector.LP.selectField,fieldType:"",values:[],application:"",include:[],expand:!1,forceSearchInItem:!0},_init:function(){this.selectType="formfield",this.className="FormField"},loadSelectItems:function(e){this.options.application&&this.designerAction.listFormField(this.options.application,function(e){if(this.fieldData=e.data,this.options.fieldType){var t=(e.data[this.options.fieldType]||[]).concat(this.options.include);t&&t.length&&t.each(function(e){e.id=e.name;var t=this._newItem(e,this,this.itemAreaNode);this.items.push(t)}.bind(this))}else Object.each(e.data,function(e,t){this._newItemCategory({name:t,data:e},this,this.itemAreaNode)}.bind(this))}.bind(this))},_scrollEvent:function(e){return!0},_getChildrenItemIds:function(){return null},_newItemCategory:function(e,t,i,n){return new MWF.xApplication.Selector.FormField.ItemCategory(e,t,i,n)},_listItemByKey:function(e,t,i){var n=[];this.options.fieldType?n=this.fieldData[this.options.fieldType]:Object.each(this.fieldData,function(e,t){n=n.length?n.concat(e):e}.bind(this));var o=[];n.each(function(e){-1!==e.name.toLowerCase().indexOf(i.toLowerCase())&&o.push(e)}.bind(this)),e&&e.apply(this,[{data:o}])},_getItem:function(e,t,i,n){e&&e.apply(this,[{data:{name:i,id:i}}])},_newItemSelected:function(e,t,i){return new MWF.xApplication.Selector.FormField.ItemSelected(e,t,i)},_listItemByPinyin:function(e,t,i){this._listItemByKey(e,t,i)},_newItem:function(e,t,i,n){return new MWF.xApplication.Selector.FormField.Item(e,t,i,n)}}),MWF.xApplication.Selector.FormField.Item=new Class({Extends:MWF.xApplication.Selector.Identity.Item,_getShowName:function(){return this.data.name},_setIcon:function(){this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/default/icon/processicon.png)")},checkSelectedSingle:function(){this.selector.options.values.filter(function(e,t){return"object"===typeOf(e)?this.data.name===e.name:"string"===typeOf(e)&&this.data.name===e}.bind(this)).length&&this.selectedSingle()},checkSelected:function(){var e=this.selector.selectedItems.filter(function(e,t){return e.data.name===this.data.name}.bind(this));e.length&&(e[0].addItem(this),this.selectedItem=e[0],this.setSelected())},loadSubItem:function(){return!1},getData:function(e){e&&e()}}),MWF.xApplication.Selector.FormField.ItemSelected=new Class({Extends:MWF.xApplication.Selector.Identity.ItemSelected,getData:function(e){e&&e()},_getShowName:function(){return this.data.name},_setIcon:function(){this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/default/icon/processicon.png)")},check:function(){if(this.selector.items.length){var e=this.selector.items.filter(function(e,t){return e.data.name===this.data.name}.bind(this));this.items=e,e.length&&e.each(function(e){e.selectedItem=this,e.setSelected()}.bind(this))}}}),MWF.xApplication.Selector.FormField.ItemCategory=new Class({Extends:MWF.xApplication.Selector.Identity.ItemCategory,_setIcon:function(){this.iconNode.setStyle("background-image","url(../x_component_Selector/$Selector/default/icon/applicationicon.png)")},loadSub:function(e){this.loaded?e&&e():(this.selector.fieldData[this.data.name].each(function(e){var t=this.selector._newItem(e,this.selector,this.children,this.level+1);this.selector.items.push(t)}.bind(this)),this.loaded=!0,e&&e())},_hasChild:function(){var e=this.selector.fieldData[this.data.name];return e&&e.length}});