layout=window.layout||{};var locate=window.location;layout.protocol=locate.protocol;var href=locate.href;-1!==href.indexOf("debugger")&&(layout.debugger=!0),layout.desktop=layout,layout.session=layout.session||{},o2.addReady((function(){o2.load(["../o2_lib/mootools/plugin/mBox.Notice.js","../o2_lib/mootools/plugin/mBox.Tooltip.js"],{sequence:!0},(function(){MWF.loadLP("zh-cn"),MWF.require("MWF.xDesktop.Layout",(function(){MWF.require("MWF.xDesktop.Authentication",null,!1),MWF.require("MWF.xDesktop.Common",null,!1),layout.load=function(){var t=href.toURI().getData("redirect");MWF.require("MWF.xDesktop.Actions.RestActions",(function(){var o=new MWF.xDesktop.Actions.RestActions("","x_organization_assemble_authentication","");o.getActions=function(t){this.actions={info:{uri:"/jaxrs/dingding/info",method:"POST"},auth:{uri:"/jaxrs/dingding/code/{code}"}},t&&t()},o.invoke({name:"info",async:!0,data:{url:href},success:function(e){var n=e.data;dd.config({agentId:n.agentid,corpId:n.corpId,timeStamp:n.timeStamp,nonceStr:n.nonceStr,signature:n.signature,jsApiList:["runtime.info"]}),dd.runtime.permission.requestAuthCode({corpId:n.corpId,onSuccess:function(e){o.invoke({name:"auth",async:!0,parameter:{code:e.code},success:function(o){t?(history.replaceState(null,"page",t),t.toURI().go()):(history.replaceState(null,"page","../x_desktop/appMobile.html?app=process.TaskCenter"),"appMobile.html?app=process.TaskCenter".toURI().go())}.bind(this),failure:function(t,o,e){history.replaceState(null,"page","../x_desktop/appMobile.html?app=process.TaskCenter"),"appMobile.html?app=process.TaskCenter".toURI().go()}.bind(this)})}.bind(this),onFail:function(t){}})}.bind(this),failure:function(t,o,e){}.bind(this)})}))},layout.isAuthentication=function(){layout.authentication=new MWF.xDesktop.Authentication({onLogin:layout.load.bind(layout)});var t=!0;return this.authentication.isAuthenticated(function(t){this.user=t.data,layout.session.user=t.data}.bind(this),function(){this.authentication.loadLogin(this.node),t=!1}.bind(this)),t},layout.notice=function(t,o,e,n,i){n||(n={x:"right",y:"top"}),e||(e=this.content),o||(o="ok");var a=e||$(document.body),s=i;s||(s={x:10,y:(n.y.toString().toLowerCase(),10)}),new mBox.Notice({type:o,position:n,move:!1,target:a,delayClose:"error"==o?1e4:5e3,offset:s,content:t})},MWF.getJSON("res/config/config.json",(function(t){layout.config=t,MWF.xDesktop.getServiceAddress(layout.config,function(t,o){layout.serviceAddressList=t,layout.centerServer=o,layout.load()}.bind(this))}))}))}))}));