MWF.xApplication.Strategy=MWF.xApplication.Strategy||{},MWF.require("MWF.widget.Identity",null,!1),MWF.xDesktop.requireApp("Template","Explorer",null,!1),MWF.xDesktop.requireApp("Template","MDomItem",null,!1),MWF.xApplication.Strategy.options.multitask=!0,MWF.xApplication.Strategy.Main=new Class({Extends:MWF.xApplication.Common.Main,Implements:[Options,Events],options:{style:"default",name:"Strategy",icon:"icon.png",width:"1200",height:"700",isResize:!0,isMax:!0,title:MWF.xApplication.Strategy.LP.title},onQueryLoad:function(){this.lp=MWF.xApplication.Strategy.LP,this.app=this},loadApplication:function(){this.user=layout.desktop.session.user.name,this.distinguishedName=layout.desktop.session.user.distinguishedName,this.userGender=layout.desktop.session.user.genderType,this.actions=MWF.Actions.get("x_strategydeploy_assemble_control"),this.initProfile(this.createContainer()),this.addEvent("resize",function(){this.resizeContent()}.bind(this))},recordStatus:function(){return{currentNavi:this.currentNavi}},resizeContent:function(){var e=this.container.getSize();this.middleContent.setStyles({height:e.y-this.naviTab.getHeight()+"px"})},createShade:function(e,t){var i=this.content,s=e||i,n=t||"loading...";this.shadeDiv&&$(this.shadeDiv).destroy(),this.shadeTxtDiv&&this.shadeTxtDiv.destroy(),this.shadeDiv=new Element("div.shadeDiv").inject(s),this.inforDiv=new Element("div.inforDiv",{styles:{height:"16px",display:"inline-block",position:"absolute","background-color":"#000000","border-radius":"3px",padding:"5px 10px"}}).inject(this.shadeDiv),this.loadImg=new Element("img.loadImg",{styles:{width:"16px",height:"16px",float:"left"},src:this.path+"default/icon/loading.gif"}).inject(this.inforDiv),this.shadeTxtSpan=new Element("span.shadeTxtSpan").inject(this.inforDiv),this.shadeTxtSpan.set("text",n),this.shadeDiv.setStyles({width:"100%",height:"100%",position:"absolute",opacity:"0.6","background-color":"#cccccc","z-index":"999"}),this.shadeTxtSpan.setStyles({color:"#ffffff","font-size":"12px",display:"inline-block","line-height":"16px","padding-left":"5px"});var a=s.getSize().x,o=s.getSize().y;this.shadeDiv.setStyles({left:s.getLeft()-i.getLeft()+"px",top:s.getTop()-i.getTop()+"px",width:a+"px",height:o+"px"}),"absolute"==s.getStyle("position")&&this.shadeDiv.setStyles({left:"0px",top:"0px"}),this.inforDiv.setStyles({left:a/2+"px",top:o/2+"px"})},destroyShade:function(){this.shadeDiv&&$(this.shadeDiv).destroy()},showErrorMessage:function(e,t,i){var s,n=i;if(e&&(s=e.responseText),""!=s){var a=JSON.parse(s);a.message?this.notice(a.message,"error"):this.notice(n,"error")}else this.notice(n,"error")},initProfile:function(e){e&&e()},createContainer:function(){this.container||(this.content.setStyle("overflow","hidden"),this.container=new Element("div.container",{styles:this.css.container}).inject(this.content)),this.naviTab=new Element("div.naviTab",{styles:this.css.naviTab}).inject(this.container),this.keyWorkTab=new Element("div.keyWorkTab",{styles:this.css.keyWorkTab}).inject(this.naviTab),this.keyWorkTabImg=new Element("div.keyWorkTabImg",{styles:this.css.keyWorkTabImg}).inject(this.keyWorkTab),this.keyWorkTabLabel=new Element("div.keyWorkTabLabel",{styles:this.css.keyWorkTabLabel,text:this.lp.keyWork.name}).inject(this.keyWorkTab),this.keyWorkTab.addEvents({click:function(){this.openTab("keyWork")}.bind(this),mouseover:function(){"keyWork"!=this.currentNavi&&(this.keyWorkTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zdgj_click.png')"}),this.keyWorkTabLabel.setStyles({color:"#3C76B7"}))}.bind(this),mouseout:function(){"keyWork"!=this.currentNavi&&(this.keyWorkTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zdgj.png')"}),this.keyWorkTabLabel.setStyles({color:"#333333"}))}.bind(this)}),this.measureTab=new Element("div.measureTab",{styles:this.css.measureTab}).inject(this.naviTab),this.measureTabImg=new Element("div.measureTabImg",{styles:this.css.measureTabImg}).inject(this.measureTab),this.measureTabLabel=new Element("div.measureTabLabel",{styles:this.css.measureTabLabel,text:this.lp.measure.name}).inject(this.measureTab),this.measureTab.addEvents({click:function(){this.openTab("measure")}.bind(this),mouseover:function(){"measures"!=this.currentNavi&&(this.measureTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zljc_click.png')"}),this.measureTabLabel.setStyles({color:"#3C76B7"}))}.bind(this),mouseout:function(){"measure"!=this.currentNavi&&(this.measureTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zljc.png')"}),this.measureTabLabel.setStyles({color:"#333333"}))}.bind(this)}),this.middleContent=new Element("div.middleContent",{styles:this.css.middleContent}).inject(this.container),this.openTab(this.status?this.status.currentNavi:null),this.resizeContent()},openTab:function(e){var t=e||"keyWork";this.changeNaviSelected(t),this.currentNavi=t,"keyWork"==t?(this.middleContent.empty(),MWF.xDesktop.requireApp("Strategy","KeyWorkList",function(){this.keyWorkList=new MWF.xApplication.Strategy.KeyWorkList(this.middleContent,this,this.actions),this.keyWorkList.load()}.bind(this))):"measure"==t?(this.middleContent.empty(),MWF.xDesktop.requireApp("Strategy","MeasureList",function(){this.measureList=new MWF.xApplication.Strategy.MeasureList(this.middleContent,this,this.actions),this.measureList.load()}.bind(this))):"priority"==t&&(this.middleContent.empty(),MWF.xDesktop.requireApp("Strategy","PriorityList",function(){this.priorityList=new MWF.xApplication.Strategy.PriorityList(this.middleContent,this,this.actions),this.priorityList.load()}.bind(this)))},changeNaviSelected:function(e){"keyWork"==e?(this.keyWorkTab.setStyles({"border-bottom":"2px solid #4990E2"}),this.measureTab.setStyles({"border-bottom":"0px"}),this.keyWorkTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zdgj_click.png')"}),this.keyWorkTabLabel.setStyles({color:"#3C76B7"}),this.measureTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zljc.png')"}),this.measureTabLabel.setStyles({color:"#333333"})):"measure"==e?(this.keyWorkTab.setStyles({"border-bottom":"0px"}),this.measureTab.setStyles({"border-bottom":"2px solid #4990E2"}),this.keyWorkTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zdgj.png')"}),this.keyWorkTabLabel.setStyles({color:"#333333"}),this.measureTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zljc_click.png')"}),this.measureTabLabel.setStyles({color:"#3C76B7"})):"priority"==e&&(this.keyWorkTab.setStyles({"border-bottom":"0px"}),this.measureTab.setStyles({"border-bottom":"0px"}),this.keyWorkTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zdgj.png')"}),this.keyWorkTabLabel.setStyles({color:"#333333"}),this.measureTabImg.setStyles({"background-image":"url('../x_component_Strategy/$Main/default/icon/icon_zljc.png')"}),this.measureTabLabel.setStyles({color:"#333333"}))}});